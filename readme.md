# Bluetooth Copy

このツールは特定のフォルダ内のファイルをBluetoothでつながっている別のPCにコピーします。
お互いに送信用と受信用のフォルダを持っていて相互にファイルのやり取りが可能です。

# 動作環境

Windows 10 64bit (1903)で開発及び動作確認をしています。.NET Framework 4.6が必要です。

# セットアップ

## 事前準備

1. ファイルをやり取りする2台のPCでBluetoothを有効にします。
1. どちらか1台のPCからBluetooth機器検索で相手先PCを検出します。
1. 機器を選択したらペアリングを行います。現状だと6桁のランダムな番号がお互いに表示され、同じ番号であればOKとします。
1. 両方のPCのペアリング機器にお互いのPC名が存在することを確認します。

## アプリケーション設定

1. 適当なフォルダにリリースzipファイルをコピーして解凍します。
1. どちらか片方のPCをサーバモード、もう片方をクライアントモードにするか決めます。サーバモードを設定したほうは送受信したファイルをアーカイブするようになっていますのでNASなどへコピーするほうをサーバモードにします。
1. `BluetoothCopy.exe.config`をテキストエディタで開いて、アプリケーション設定を変更します。
    - Mode : 動作モードを指定します。ServerもしくはClientを設定します。
    - ArchiveDirectoryPath : Serverモードの時のみ有効です。送受信されたファイルをアーカイブするフォルダを指定します。アプリケーション側でファイルを削除することはありません。
    - SendDirectoryPath : 相手のPCに送信するファイルを格納するフォルダです。送信後にファイルは削除されます。
    - ReceiveDirectoryPath : 相手のPCから受信したファイルを格納するフォルダです。アプリケーション側でファイルを削除することはありません。

# 操作方法

1. サーバモードを指定したPCのアプリケーションを起動します。
1. クライアントモードを指定したPCのアプリケーションを起動します。
1. クライアント側の「接続」ボタンをクリックするとペアリング済の機器一覧が表示されます。ここから相手先PCを選択するとBluetooth接続が行われます。
1. 送りたいファイルを送信用フォルダにコピーします。
1. コピーしたファイルが送信用フォルダから消え、相手先PCの受信用フォルダに生成されます。また、サーバのアーカイブフォルダにもタイムスタンプ付きでコピーされます。
1. 終了したい場合は、クライアントを「×」で終了させた後、サーバを「×」で終了させます。

# 注意点

- Bluetoothを使用したファイル転送の速度は約200KB/秒です。なので、数十～数百MBのファイルを送るときは時間がかかります。

- このツールはBluetooth Classicを使用しています。送信するファイルデータ自体は暗号化していませんのでBluetooth自体の暗号強度に依存します。Bluetoothの機器検索で検出するようにPCを設定していると不正な機器を接続される恐れがありますので、ペアリングが終わったら検出されないように設定してください。

- Bluetooth Class 3の長距離通信は盗聴のリスクが高くなるためできればClass1や2を使ってください。Class 1は数m以内、Class 2は10m以内の通信距離なので部屋の外から接続されるリスクは低減されます。
